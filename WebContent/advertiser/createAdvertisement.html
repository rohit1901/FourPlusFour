<!DOCTYPE html>
<html lang="en" class="no-js">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
		<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
		<title>Create a new Advertisement</title>
		<meta name="description" content="Create a new Advertisement" />
		<meta name="keywords" content="Natural Language UI, sentence form, text input, contenteditable, html5, css3, jquery" />
		<meta name="author" content="FourPlusFour.org" />
		<link rel="shortcut icon" href="../favicon.ico"> 
		<link rel="stylesheet" type="text/css" href="css/default_createAdvertisement.css" />
		<link rel="stylesheet" type="text/css" href="css/component_createAdvertisement.css" />
		<script src="js/modernizr.custom_createAdvertisement.js"></script>
		<link rel="stylesheet" type="text/css" href="../css/ns-default-alert.css" />
		<link rel="stylesheet" type="text/css" href="../css/ns-style-growl-alert.css" />
		<script src="../js/modernizr.custom-alert.js"></script>
	</head>
	<body class="nl-blurred">
		<div class="container demo-1">
			<!-- Top Navigation -->
			<div class="codrops-top clearfix">
				<a class="codrops-icon codrops-icon-prev" href="advertiserDashboard.html"><span>Advertiser Dashboard</span></a>
			</div>
			<header>
				<h1>Create a new Advertisement <span>by filling up the following details</span></h1>	
			</header>
			<div class="main clearfix">
				<form id="nl-form" class="nl-form">
					<input type="hidden" name="q1" id="q1"></input>
                    I want to offer
                    <select id="q2" name="q2">
						<option value="10%" selected>10%</option>
						<option value="15%">15%</option>
						<option value="20%">20%</option>
						<option value="25%">25%</option>
						<option value="30%">30%</option>
					</select>
					<br />discount on
					<input type="text" id="q3" name="q3" value="" placeholder="product" data-subline="For example: <em>Pens</em> or <em>Pencil</em>"/>
					. This offer is valid for the next 1 month only on<input type="text" id="q4" name="q4"value="" placeholder="www.fourplusfour.org" data-subline="For example: <em>www.fourplusfour.org</em>"/>
					<div class="nl-submit-wrap">
						<button class="nl-submit" type="submit" id="submitAd">Create Ad</button>
					</div>
					<div class="nl-overlay"></div>
				</form>
			</div>
		</div><!-- /container -->
		<script src="js/nlform.js"></script>
		<script src="../js/classie-alert.js"></script>
		<script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
		<script src="../js/notificationFx-alert.js"></script>
		<script>
			var nlform = new NLForm( document.getElementById( 'nl-form' ) );
            var queryString = window.location.search;
            var email = getParameter("email", queryString);
            
            $("#q1").text(email);
            $("#q1").val(email);
            
			$("#submitAd").click(function(event)
			{
				event.preventDefault();
                var postData = $("#nl-form").serializeArray();
                var formURL = "http://fast-coast-6607.herokuapp.com/credentialService/createAdvertisement";
                $.ajax(
                {
                    url : formURL,
                    type: "POST",
                    data : postData,
                    success:function(data, textStatus, jqXHR) 
                    {
                        /*
						alert("Details submitted successfully. Press OK to login using your new credentials.");
                        window.location.href="advertiserDashboard.html?email=" + email;
						*/
						var notification = new NotificationFx({
							message : '<p>Details submitted successfully.\nThis page will redirect automatically in a jiffy!</p>',
							layout : 'growl',
							effect : 'slide',
							type : 'notice', // notice, warning or error
							onClose : function() {
								window.location.href="advertiserDashboard.html?email=" + email;
							}
						});

						// show the notification
						notification.show();

                    },
                    error: function(jqXHR, textStatus, errorThrown) 
                    {
                        var notification = new NotificationFx({
							message : '<p>Some error occurred! Error----.' + errorThrown + '\nThis page will reload automatically in a jiffy!</p>',
							layout : 'growl',
							effect : 'slide',
							type : 'notice', // notice, warning or error
							onClose : function() {
								location.reload(true);
							}
						});

						// show the notification
						notification.show();
                    },
                    done: function()
                    {
                        
                    }
                });
			});
            function getParameter(parameter, queryString)
            {
                var parameterValue;
                var queryStringParts = queryString.split("&");
                $.each(queryStringParts, function(index, value)
                        {
                            if(value.search(parameter) != -1)
                            {
                                var parameterValueArr = value.split("=");
                                console.log("parameter " + parameter + "----" + parameterValueArr[1]);
                                parameterValue = parameterValueArr[1];
                            }
                        });
                return parameterValue;
            }
		</script>
	</body>
</html>